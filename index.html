<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mock Browser — Draggable + Resizable (Iframe Preview)</title>
<style>
  :root{
    --titlebar-bg:#2b2d31;
    --titlebar-fg:#d1d5db;
    --toolbar-bg:#1f232a;
    --omnibox-bg:#0f1217;
    --omnibox-fg:#e5e7eb;
    --omnibox-border:#374151;
    --btn-hover:rgba(255,255,255,.08);
    --control-fg:#cfd3da;          /* normal glyph color */
    --close-hover:#e81123;         /* Chrome red hover */
    --titlebar-height:32px;
    --toolbar-height:40px;

    --content-bg:#181a20;
    --shadow:0 18px 50px rgba(0,0,0,.45);
    --accent:#60a5fa;
  }
  *{ box-sizing:border-box; }
  body{ margin:0; background:#111; color:#ddd; font:14px/1.4 system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif; }

  .window{
    position:fixed; top:64px; left:64px;
    width:1000px; height:680px;
    background:#15171c; border-radius:8px; overflow:hidden; box-shadow:var(--shadow);
  }
  .window.maximized{ top:0 !important; left:0 !important; width:100vw !important; height:100vh !important; border-radius:0; }
  .window.minimized .content{ display:none; }

  .titlebar{
    height:var(--titlebar-height);
    display:grid; grid-template-columns:1fr auto; align-items:center;
    background:var(--titlebar-bg); color:var(--titlebar-fg);
    padding:0 8px; gap:8px; border-bottom:1px solid rgba(255,255,255,.06);
    user-select:none; cursor:grab; touch-action:none;
  }
  .titlebar.dragging{ cursor:grabbing; }
  .titlebar .left{ display:flex; align-items:center; gap:8px; min-width:0; }
  .chrome-logo-img{ display:block; width:14px; height:14px; object-fit:contain; filter:drop-shadow(0 0 .25px rgba(0,0,0,.6)); }
  .title{ font-size:13px; opacity:.9; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

  /* Window controls (Chrome-like) */
  .window-controls{ display:grid; grid-auto-flow:column; grid-auto-columns:46px; height:100%; }
  .btn{
    appearance:none; border:0; background:transparent; color:var(--control-fg);
    display:grid; place-items:center; height:100%; cursor:pointer;
  }
  .btn:hover{ background:var(--btn-hover); }
  .btn:active{ filter:brightness(.95); }
  .btn.close:hover{ background:var(--close-hover); color:#fff; } /* red hover like Chrome */

  .ico{ width:16px; height:16px; display:block; }
  .ico line, .ico rect, .ico path{ stroke:currentColor; stroke-width:1.6; vector-effect:non-scaling-stroke; }
  .ico.min line{ stroke-linecap:square; }   /* crisp bar */
  .ico.max rect{ fill:none; }               /* square outline */
  .ico.close-x path{ stroke-linecap:square; } /* crisp square-capped X */

  .toolbar{
    height:var(--toolbar-height);
    display:flex; align-items:center; gap:8px;
    background:var(--toolbar-bg); border-bottom:1px solid rgba(255,255,255,.06);
    padding:0 8px; user-select:none; cursor:grab; touch-action:none;
  }
  .toolbar.dragging{ cursor:grabbing; }

  .omnibox{
    display:flex; align-items:center; gap:8px; flex:1; height:28px;
    background:var(--omnibox-bg); color:var(--omnibox-fg);
    border:1px solid var(--omnibox-border); border-radius:14px; padding:0 10px;
    cursor:auto;
  }
  .omnibox .lock{ width:14px; height:14px; color:#10b981; flex:0 0 auto; }
  .omnibox input{ flex:1; background:transparent; border:0; outline:0; color:inherit; font:inherit; }
  .bookmark{ width:16px; height:16px; color:#c7cbd3; cursor:pointer; }
  .bookmark.active{ color:#f59e0b; }

  .content{
    height:calc(100% - var(--titlebar-height) - var(--toolbar-height));
    background:var(--content-bg); position:relative;
  }

  .frame-wrap{ position:absolute; inset:0; }
  .frame-wrap iframe{ position:absolute; inset:0; width:100%; height:100%; border:0; background:#0b0e13; display:block; }
  .frame-overlay{
    position:absolute; inset:0; display:none; align-items:center; justify-content:center; text-align:center;
    padding:24px; background:linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,.55));
  }
  .frame-overlay.show{ display:flex; }
  .frame-overlay .panel{
    background:rgba(17,24,39,.85); border:1px solid rgba(255,255,255,.12); color:#d1d5db;
    border-radius:12px; padding:16px 18px; max-width:min(720px, 92%); box-shadow:var(--shadow);
  }
  .panel h3{ margin:0 0 8px; font-size:16px; }
  .panel p{ margin:0 0 12px; font-size:13px; opacity:.95; }
  .panel .row{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }
  .btn-link, .btn-ghost{
    display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:8px; text-decoration:none; font-weight:600; font-size:13px;
  }
  .btn-link{ color:#0b1220; background:var(--accent); }
  .btn-ghost{ color:#e5e7eb; border:1px solid rgba(255,255,255,.14); background:rgba(255,255,255,.06); }
  .btn-link:hover{ filter:brightness(0.95); }
  .btn-ghost:hover{ background:rgba(255,255,255,.1); }

  /* Resize handles */
  .resizer{ position:absolute; touch-action:none; z-index:20; }
  .resizer.n  { cursor:ns-resize; top:calc(var(--titlebar-height) + var(--toolbar-height) - 4px); left:0; right:0; height:8px; }
  .resizer.e  { cursor:ew-resize; right:-4px; top:0; bottom:0; width:8px; }
  .resizer.s  { cursor:ns-resize; bottom:-4px; left:0; right:0; height:8px; }
  .resizer.w  { cursor:ew-resize; left:-4px; top:0; bottom:0; width:8px; }
  .resizer.ne { cursor:nesw-resize; right:-6px; top:calc(var(--titlebar-height) + var(--toolbar-height) - 6px); width:12px; height:12px; }
  .resizer.nw { cursor:nwse-resize; left:-6px;  top:calc(var(--titlebar-height) + var(--toolbar-height) - 6px); width:12px; height:12px; }
  .resizer.se { cursor:nwse-resize; right:-6px; bottom:-6px; width:12px; height:12px; }
  .resizer.sw { cursor:nesw-resize; left:-6px;  bottom:-6px; width:12px; height:12px; }
  .window.maximized .resizer{ display:none; }
</style>
</head>
<body>
  <div class="window" id="fakeWindow">
    <div class="titlebar" id="titlebar">
      <div class="left">
        <img src="https://www.google.com/chrome/static/images/chrome-logo.svg" alt="Google Chrome" width="14" height="14" class="chrome-logo-img" decoding="async" />
        <div class="title" id="title">Preview — Google Chrome</div>
      </div>
      <div class="window-controls">
        <button class="btn" id="minBtn" title="Minimize" aria-label="Minimize">
          <svg class="ico min" viewBox="0 0 16 16" aria-hidden="true"><line x1="3" y1="8.5" x2="13" y2="8.5"/></svg>
        </button>
        <button class="btn" id="maxBtn" title="Maximize" aria-label="Maximize">
          <svg class="ico max" viewBox="0 0 16 16" aria-hidden="true"><rect x="3.5" y="3.5" width="9" height="9"/></svg>
        </button>
        <!-- Chrome-like Close button (square-capped X, proper weight, red hover) -->
        <button class="btn close" id="closeBtn" title="Close" aria-label="Close">
          <svg class="ico close-x" viewBox="0 0 16 16" aria-hidden="true">
            <path d="M3.8 3.8L12.2 12.2M12.2 3.8L3.8 12.2"/>
          </svg>
        </button>
      </div>
    </div>

    <div class="toolbar" id="toolbar">
      <div class="omnibox">
        <svg class="lock" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M7 10V8a5 5 0 0 1 10 0v2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
          <rect x="5" y="10" width="14" height="10" rx="2" stroke="currentColor" stroke-width="1.6"/>
        </svg>
        <input id="urlInput" value="https://example.com" spellcheck="false" autocomplete="off" />
        <svg class="bookmark" id="bookmarkBtn" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
          <path d="M6 4h12a1 1 0 0 1 1 1v15l-7-4-7 4V5a1 1 0 0 1 1-1z"/>
        </svg>
      </div>
    </div>

    <div class="content">
      <div class="frame-wrap">
        <iframe id="appFrame" title="Preview frame" loading="lazy" referrerpolicy="no-referrer"
                sandbox="allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock"></iframe>
        <div class="frame-overlay" id="frameOverlay">
          <div class="panel">
            <h3>Can’t show this site inside the window</h3>
            <p>The site may block embedding (X-Frame-Options/CSP). You can still open it in a new tab or load a built‑in example page here.</p>
            <div class="row">
              <a id="openLink" href="#" target="_blank" rel="noopener noreferrer" class="btn-link">Open in new tab</a>
              <a id="showBuiltIn" href="#" class="btn-ghost">Load built‑in Example page</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Resize handles -->
    <div class="resizer n"  data-dir="n"></div>
    <div class="resizer e"  data-dir="e"></div>
    <div class="resizer s"  data-dir="s"></div>
    <div class="resizer w"  data-dir="w"></div>
    <div class="resizer ne" data-dir="ne"></div>
    <div class="resizer se" data-dir="se"></div>
    <div class="resizer sw" data-dir="sw"></div>
    <div class="resizer nw" data-dir="nw"></div>
  </div>

<script>
/* Remove/hide any nav buttons if present */
(() => {
  const css = document.createElement('style');
  css.textContent = '.nav-btn,#backBtn,#fwdBtn,#refreshBtn{display:none!important}';
  document.head.appendChild(css);
  ['backBtn','fwdBtn','refreshBtn'].forEach(id => document.getElementById(id)?.remove());
  document.querySelectorAll('.nav-btn').forEach(el => el.remove());
})();

/* Drag + Maximize + Resize */
(() => {
  const winEl = document.getElementById('fakeWindow');
  const minBtn = document.getElementById('minBtn');
  const maxBtn = document.getElementById('maxBtn');
  const closeBtn= document.getElementById('closeBtn');

  const clamp = (n, min, max) => Math.max(min, Math.min(n, max));
  const KEEP_X = 80, KEEP_Y = 48;
  const MIN_W = 700, MIN_H = 420;

  function bounds(){
    const w = winEl.offsetWidth, h = winEl.offsetHeight;
    return {
      minLeft: Math.min(KEEP_X - w, 0),
      maxLeft: Math.max(window.innerWidth  - KEEP_X, 0),
      minTop:  Math.min(KEEP_Y - h, 0),
      maxTop:  Math.max(window.innerHeight - KEEP_Y, 0)
    };
  }
  function ensureInBounds(){
    const r = winEl.getBoundingClientRect();
    const b = bounds();
    winEl.style.left = clamp(r.left, b.minLeft, b.maxLeft) + 'px';
    winEl.style.top  = clamp(r.top,  b.minTop,  b.maxTop ) + 'px';
  }

  const headerSel = '#titlebar, #toolbar';
  const blockSel  = '.window-controls, input, textarea, button, a, #bookmarkBtn';
  let dragging=false, offX=0, offY=0;

  function headerHit(target){
    const inHeader = target.closest(headerSel);
    if (!inHeader) return false;
    if (target.closest(blockSel)) return false;
    return true;
  }
  function startDrag(x,y){
    const r = winEl.getBoundingClientRect();
    offX = x - r.left; offY = y - r.top;
    dragging = true; document.body.style.userSelect='none';
  }
  function moveDrag(x,y){
    if (!dragging || winEl.classList.contains('maximized')) return;
    const b = bounds();
    winEl.style.left = clamp(x - offX, b.minLeft, b.maxLeft) + 'px';
    winEl.style.top  = clamp(y - offY, b.minTop,  b.maxTop ) + 'px';
  }
  function endDrag(){ if(!dragging) return; dragging=false; document.body.style.userSelect=''; }

  // Mouse drag
  document.addEventListener('mousedown', (e) => {
    if (e.button !== 0) return;
    if (!headerHit(e.target)) return;
    startDrag(e.clientX, e.clientY);
    e.preventDefault();
  });
  document.addEventListener('mousemove', (e) => moveDrag(e.clientX, e.clientY));
  document.addEventListener('mouseup', endDrag);

  // Touch drag
  document.addEventListener('touchstart', (e) => {
    const t = e.touches[0]; if (!t) return;
    if (!headerHit(e.target)) return;
    startDrag(t.clientX, t.clientY);
  }, {passive:false});
  document.addEventListener('touchmove', (e) => {
    const t = e.touches[0]; if (!t) return;
    moveDrag(t.clientX, t.clientY);
  }, {passive:false});
  document.addEventListener('touchend', endDrag);
  document.addEventListener('touchcancel', endDrag);

  // Resizing
  let resizing=false, dir='', start=null, startX=0, startY=0;
  document.querySelectorAll('.resizer').forEach(h => {
    h.addEventListener('pointerdown', (e) => {
      if (winEl.classList.contains('maximized')) return;
      resizing=true; dir=h.dataset.dir;
      const r = winEl.getBoundingClientRect();
      start = { left:r.left, top:r.top, right:r.right, bottom:r.bottom, width:r.width, height:r.height };
      startX=e.clientX; startY=e.clientY;
      h.setPointerCapture?.(e.pointerId);
      e.preventDefault();
    });
    h.addEventListener('pointermove', (e) => {
      if (!resizing) return;
      const dx=e.clientX-startX, dy=e.clientY-startY;
      let left=start.left, top=start.top, width=start.width, height=start.height;

      if (dir.includes('e')) width  = Math.max(MIN_W, start.width  + dx);
      if (dir.includes('s')) height = Math.max(MIN_H, start.height + dy);
      if (dir.includes('w')){
        const newLeft = Math.min(start.right - MIN_W, start.left + dx);
        width = start.right - newLeft; left = newLeft;
      }
      if (dir.includes('n')){
        const newTop = Math.min(start.bottom - MIN_H, start.top + dy);
        height = start.bottom - newTop; top = newTop;
      }

      winEl.style.left = left + 'px';
      winEl.style.top = top + 'px';
      winEl.style.width = width + 'px';
      winEl.style.height = height + 'px';
    });
    function stopResize(e){ if(!resizing) return; resizing=false; try{h.releasePointerCapture(e.pointerId);}catch{} ensureInBounds(); }
    h.addEventListener('pointerup', stopResize);
    h.addEventListener('pointercancel', stopResize);
  });

  // Window buttons
  function toggleMax(){
    if (!winEl.classList.contains('maximized')){
      const r = winEl.getBoundingClientRect();
      winEl.dataset.prev = JSON.stringify({left:r.left, top:r.top, width:r.width, height:r.height});
      winEl.classList.add('maximized');
    } else {
      winEl.classList.remove('maximized');
      try {
        const p = JSON.parse(winEl.dataset.prev||'{}');
        if (p.width) { winEl.style.left=p.left+'px'; winEl.style.top=p.top+'px'; winEl.style.width=p.width+'px'; winEl.style.height=p.height+'px'; }
      } catch {}
      ensureInBounds();
    }
  }
  document.getElementById('titlebar')?.addEventListener('dblclick', toggleMax);
  maxBtn?.addEventListener('click', toggleMax);
  minBtn?.addEventListener('click', () => winEl.classList.toggle('minimized'));
  closeBtn?.addEventListener('click', () => winEl.remove());

  // Center once
  requestAnimationFrame(() => {
    const r = winEl.getBoundingClientRect();
    if (!winEl.style.left) winEl.style.left = Math.max(16, (window.innerWidth  - r.width)/2) + 'px';
    if (!winEl.style.top)  winEl.style.top  = Math.max(16, (window.innerHeight - r.height)/3) + 'px';
    ensureInBounds();
  });
  window.addEventListener('resize', ensureInBounds);
})();

/* Iframe preview logic for example site + built-in fallback */
(() => {
  const urlInput = document.getElementById('urlInput');
  const frame = document.getElementById('appFrame');
  const overlay = document.getElementById('frameOverlay');
  const openLink = document.getElementById('openLink');
  const showBuiltIn = document.getElementById('showBuiltIn');
  const titleEl = document.getElementById('title');

  function setTitle(u){
    try { titleEl.textContent = (new URL(u)).host + ' — Google Chrome'; }
    catch { titleEl.textContent = 'Preview — Google Chrome'; }
  }

  function loadBuiltIn(){
    overlay.classList.remove('show');
    titleEl.textContent = 'example.local — Google Chrome';
    frame.removeAttribute('src');
    frame.srcdoc = `
      <!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
      <title>Example Page</title>
      <style>
        body{margin:0;font:16px system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b1220;color:#e5e7eb;display:grid;place-items:center;height:100vh;}
        .card{max-width:720px;margin:24px;padding:28px;border-radius:14px;background:#111827;border:1px solid rgba(255,255,255,.12);box-shadow:0 14px 40px rgba(0,0,0,.35);}
        h1{margin:0 0 6px;font-size:28px} p{margin:.5rem 0 0;color:#cbd5e1} a{color:#60a5fa;text-decoration:none} a:hover{text-decoration:underline}
        code{background:#0f172a;padding:.15rem .4rem;border-radius:6px}
      </style></head><body>
      <div class="card"><h1>Embedded Example Page</h1>
      <p>This is a built‑in page rendered via <code>iframe.srcdoc</code> so it always works offline.</p>
      <p>Change the URL above to something you control to preview it here.</p></div></body></html>`;
  }

  function showBlocked(u){
    frame.removeAttribute('src'); frame.removeAttribute('srcdoc');
    overlay.classList.add('show');
    openLink.href = u;
  }

  function navigate(u){
    const url = u.trim();
    setTitle(url);
    openLink.href = url;
    overlay.classList.remove('show');
    frame.removeAttribute('srcdoc');

    let done = false;
    const t = setTimeout(() => { if (!done) showBlocked(url); }, 1200);
    frame.onload = () => { done = true; clearTimeout(t); overlay.classList.remove('show'); };
    frame.onerror = () => { clearTimeout(t); showBlocked(url); };
    frame.src = url;
  }

  // Start with example.com
  navigate(urlInput.value);

  urlInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') navigate(urlInput.value);
    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'l') { urlInput.select(); e.preventDefault(); }
  });
  document.addEventListener('keydown', e => {
    if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'l') { urlInput.focus(); urlInput.select(); e.preventDefault(); }
  });

  showBuiltIn.addEventListener('click', (e) => { e.preventDefault(); loadBuiltIn(); });
  document.getElementById('bookmarkBtn')?.addEventListener('click', e => e.currentTarget.classList.toggle('active'));
})();
</script>
</body>
</html>
